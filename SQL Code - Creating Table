USE INTRAMURAL
GO

/***************************************** Creating Tables *********************************/
CREATE TABLE STUDENTS (
	Cwid		Int		NOT NULL UNIQUE,
	FName		Char(25)	NOT NULL,
	LName		Char(30)	NOT NULL,
	StudentEmail	VarChar(100)	NOT NULL,
	CONSTRAINT	STUDENTS_PK	PRIMARY KEY(Cwid)
);

CREATE TABLE COACH (
	CoachID		Int		NOT NULL UNIQUE,
	FName		Char(25)	NOT NULL,
	LName		Char(30)	NOT NULL,
	Email		VarChar(100)	NOT NULL,
	CONSTRAINT	COACH_PK	PRIMARY KEY(CoachID)
);

CREATE TABLE SPORT (
    	SportId   	Int   		NOT NULL UNIQUE,
    	SportName 	Char(30) 	NOT NULL,
    	CONSTRAINT 	SportId_PK 	PRIMARY KEY(SportId)
);

CREATE TABLE COORDINATOR (
	CoordinatorID	Int		NOT NULL UNIQUE,
	FName		Char(25)	NOT NULL,
	LName		Char(30)	NOT NULL,
	Email		VarChar(100)	NOT NULL,
	SportId		Int		NOT NULL,
	CONSTRAINT	COORDINATOR_PK	PRIMARY KEY(CoordinatorID),
	CONSTRAINT	SPORT_FK	FOREIGN KEY(SportId)
					REFERENCES SPORT(SportId)
);

CREATE TABLE REFEREE (
    	RefId  		Int  		NOT NULL UNIQUE, 
    	FName  		Char(25) 	NOT NULL,
    	LName  		Char(30) 	NOT NULL,
    	RefEmail  	VarChar(100) 	NOT NULL, 
    	CONSTRAINT 	RefId_PK 	PRIMARY KEY(RefId)
);

CREATE TABLE LOCATION (
	LocationId	Int		NOT NULL UNIQUE,
	LocationName	Char(30)	NOT NULL,
	LocationType	Char(30)	NOT NULL,
	CONSTRAINT	LOCATION_PK	PRIMARY KEY(LocationId)
);

CREATE TABLE TEAMS(
  	TeamId 		Int 		NOT NULL UNIQUE, 
  	TeamName 	Char(25) 	NOT NULL UNIQUE, 
  	SportId   	Int   		NOT NULL,
  	CoachID		Int	  	NOT NULL UNIQUE,
  	CONSTRAINT 	TEAMS_PK 	PRIMARY KEY(Teamid),
  	CONSTRAINT 	TEAMS_SPORT_FK 	FOREIGN KEY(SportId)
                            		REFERENCES SPORT(SportId),
  	CONSTRAINT 	TEAMS_COACH_FK 	FOREIGN KEY(CoachId)
                            		REFERENCES COACH(CoachId) 
  
);

CREATE TABLE STUDENT_ASSOC (
	Cwid		Int		 NOT NULL UNIQUE,
	TeamsId		Int		 NOT NULL UNIQUE,
	CONSTRAINT	STUDENT_ASSOC_PK PRIMARY KEY(Cwid, TeamsId),
	CONSTRAINT	STUDENTS_FK	 FOREIGN KEY(Cwid)
					 REFERENCES STUDENTS(Cwid),
	CONSTRAINT	TEAMS_FK	 FOREIGN KEY(TeamsId)
					 REFERENCES TEAMS(TeamId)
);

CREATE TABLE GAMES (
	GamesId		Int		NOT NULL UNIQUE,
	RefId		Int		NOT NULL,
	LocationID	Int		NOT NULL,
	GameDate	Date		NOT NULL,
	GameTime	Time		NOT NULL,
	CONSTRAINT	GAMES_PK	PRIMARY KEY(GamesId, LocationId, GameDate, GameTime),
	CONSTRAINT	REFEREE_FK	FOREIGN KEY(RefId)
					REFERENCES REFEREE(RefID),
	CONSTRAINT	LOCATION_FK	FOREIGN KEY(LocationId)
					REFERENCES LOCATION(LocationId)
);

CREATE TABLE GAMES_ASSOC (
	TeamsID		Int		NOT NULL UNIQUE,
	GamesId		Int		NOT NULL UNIQUE,
	CONSTRAINT	GAMES_ASSOC_PK	PRIMARY KEY(TeamsId, GamesId),
	CONSTRAINT	GAMES_ASSOC_TEAMS_FK	FOREIGN KEY(TeamsId)
					REFERENCES TEAMS(TeamId),
	CONSTRAINT	GAMES_FK	FOREIGN KEY(GamesId)
					REFERENCES GAMES(GamesId)
);

CREATE TABLE EQUIPMENT_INVENTORY(
  	EquipmentId 	Int 		   NOT NULL UNIQUE, 
  	EquipmentName 	VarChar(75) NOT NULL,
  	SportId   	Int   		   NOT NULL,
  	NoOfItems 	Int 		   NOT NULL,
  	CONSTRAINT 	EQUIPMENT_PK 	   PRIMARY KEY(EquipmentId),
  	CONSTRAINT 	EQUIPMENT_SPORT_FK FOREIGN KEY(SportId)
                                 	   REFERENCES SPORT(SportId)
);


CREATE TABLE EQUIPMENT_LOG(
	EquipmentId 	Int 		NOT NULL, 
	Cwid		Int		NOT NULL,
	DateBorrowed 	Date 		NOT NULL,
	DateReturned 	Date 		NOT NULL, 
	Purpose 	Char(5) 	NOT NULL,
	NoOfItemsBorrowed Int 		NOT NULL, 
	CONSTRAINT EQUIPMENT_LOG_PF 	PRIMARY KEY(EquipmentId, Cwid, DateBorrowed, Purpose),
	CONSTRAINT EQUIPMENT_LOG_STUDENTS_FK FOREIGN KEY(Cwid)
					     REFERENCES STUDENTS(Cwid),
	CONSTRAINT EQUIPMENT_LOG_EQUIPMENT_INV_FK FOREIGN KEY(EquipmentId)
						    REFERENCES EQUIPMENT_INVENTORY(EquipmentId)                               
);
